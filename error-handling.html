<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>5.2 Error Handling | mlr3 manual</title>
<meta name="description" content="5.2 Error Handling | mlr3 manual ">
<meta name="generator" content="bookdown 0.16 and GitBook 2.6.7">
<meta property="og:title" content="5.2 Error Handling | mlr3 manual">
<meta property="og:type" content="book">
<meta property="og:url" content="https://mlr3book.mlr-org.com">
<meta name="github-repo" content="mlr-org/mlr3book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="5.2 Error Handling | mlr3 manual">
<meta name="author" content="The mlr-org Team">
<meta name="date" content="2019-12-24">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="prev" href="parallelization.html">
<link rel="next" href="backends.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script><link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet">
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation"><ul class="summary">
<li><a href="./">mlr3 Manual <img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" width="30"></a></li>

<li class="divider">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Quickstart</a></li>
<li class="chapter" data-level="1" data-path="introduction-and-overview.html"><a href="introduction-and-overview.html"><i class="fa fa-check"></i><b>1</b> Introduction and Overview</a></li>
<li class="chapter" data-level="2" data-path="basics.html">
<a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basics</a><ul>
<li class="chapter" data-level="2.1" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>2.1</b> Quick R6 Intro for Beginners</a></li>
<li class="chapter" data-level="2.2" data-path="tasks.html">
<a href="tasks.html"><i class="fa fa-check"></i><b>2.2</b> Tasks</a><ul>
<li class="chapter" data-level="2.2.1" data-path="tasks.html"><a href="tasks.html#tasks-types"><i class="fa fa-check"></i><b>2.2.1</b> Task Types</a></li>
<li class="chapter" data-level="2.2.2" data-path="tasks.html"><a href="tasks.html#tasks-creation"><i class="fa fa-check"></i><b>2.2.2</b> Task Creation</a></li>
<li class="chapter" data-level="2.2.3" data-path="tasks.html"><a href="tasks.html#tasks-predefined"><i class="fa fa-check"></i><b>2.2.3</b> Predefined tasks</a></li>
<li class="chapter" data-level="2.2.4" data-path="tasks.html">
<a href="tasks.html#tasks-api"><i class="fa fa-check"></i><b>2.2.4</b> Task API</a><ul>
<li class="chapter" data-level="2.2.4.1" data-path="tasks.html"><a href="tasks.html#tasks-retrieving"><i class="fa fa-check"></i><b>2.2.4.1</b> Retrieving Data</a></li>
<li class="chapter" data-level="2.2.4.2" data-path="tasks.html"><a href="tasks.html#tasks-roles"><i class="fa fa-check"></i><b>2.2.4.2</b> Roles (Rows and Columns)</a></li>
<li class="chapter" data-level="2.2.4.3" data-path="tasks.html"><a href="tasks.html#tasks-mutators"><i class="fa fa-check"></i><b>2.2.4.3</b> Task Mutators</a></li>
</ul>
</li>
<li class="chapter" data-level="2.2.5" data-path="tasks.html"><a href="tasks.html#autoplot-task"><i class="fa fa-check"></i><b>2.2.5</b> Plotting Tasks</a></li>
</ul>
</li>
<li class="chapter" data-level="2.3" data-path="learners.html">
<a href="learners.html"><i class="fa fa-check"></i><b>2.3</b> Learners</a><ul>
<li class="chapter" data-level="2.3.1" data-path="learners.html"><a href="learners.html#learners-predefined"><i class="fa fa-check"></i><b>2.3.1</b> Predefined Learners</a></li>
</ul>
</li>
<li class="chapter" data-level="2.4" data-path="train-predict.html">
<a href="train-predict.html"><i class="fa fa-check"></i><b>2.4</b> Train and Predict</a><ul>
<li class="chapter" data-level="2.4.1" data-path="train-predict.html"><a href="train-predict.html#train-predict-objects"><i class="fa fa-check"></i><b>2.4.1</b> Creating Task and Learner Objects</a></li>
<li class="chapter" data-level="2.4.2" data-path="train-predict.html"><a href="train-predict.html#split-data"><i class="fa fa-check"></i><b>2.4.2</b> Setting up the train/test splits of the data</a></li>
<li class="chapter" data-level="2.4.3" data-path="train-predict.html"><a href="train-predict.html#training"><i class="fa fa-check"></i><b>2.4.3</b> Training the learner</a></li>
<li class="chapter" data-level="2.4.4" data-path="train-predict.html"><a href="train-predict.html#predicting"><i class="fa fa-check"></i><b>2.4.4</b> Predicting</a></li>
<li class="chapter" data-level="2.4.5" data-path="train-predict.html"><a href="train-predict.html#predict-type"><i class="fa fa-check"></i><b>2.4.5</b> Changing the Predict Type</a></li>
<li class="chapter" data-level="2.4.6" data-path="train-predict.html"><a href="train-predict.html#autoplot-prediction"><i class="fa fa-check"></i><b>2.4.6</b> Plotting Predictions</a></li>
<li class="chapter" data-level="2.4.7" data-path="train-predict.html"><a href="train-predict.html#measure"><i class="fa fa-check"></i><b>2.4.7</b> Performance assessment</a></li>
</ul>
</li>
<li class="chapter" data-level="2.5" data-path="resampling.html">
<a href="resampling.html"><i class="fa fa-check"></i><b>2.5</b> Resampling</a><ul>
<li class="chapter" data-level="2.5.1" data-path="resampling.html"><a href="resampling.html#resamp-settings"><i class="fa fa-check"></i><b>2.5.1</b> Settings</a></li>
<li class="chapter" data-level="2.5.2" data-path="resampling.html"><a href="resampling.html#resampling-inst"><i class="fa fa-check"></i><b>2.5.2</b> Instantiation</a></li>
<li class="chapter" data-level="2.5.3" data-path="resampling.html"><a href="resampling.html#resampling-exec"><i class="fa fa-check"></i><b>2.5.3</b> Execution</a></li>
<li class="chapter" data-level="2.5.4" data-path="resampling.html"><a href="resampling.html#resamp-custom"><i class="fa fa-check"></i><b>2.5.4</b> Custom resampling</a></li>
<li class="chapter" data-level="2.5.5" data-path="resampling.html"><a href="resampling.html#autoplot-resampleresult"><i class="fa fa-check"></i><b>2.5.5</b> Plotting Resample Results</a></li>
</ul>
</li>
<li class="chapter" data-level="2.6" data-path="benchmarking.html">
<a href="benchmarking.html"><i class="fa fa-check"></i><b>2.6</b> Benchmarking</a><ul>
<li class="chapter" data-level="2.6.1" data-path="benchmarking.html"><a href="benchmarking.html#bm-design"><i class="fa fa-check"></i><b>2.6.1</b> Design Creation</a></li>
<li class="chapter" data-level="2.6.2" data-path="benchmarking.html"><a href="benchmarking.html#bm-exec"><i class="fa fa-check"></i><b>2.6.2</b> Execution and Aggregation of Results</a></li>
<li class="chapter" data-level="2.6.3" data-path="benchmarking.html"><a href="benchmarking.html#autoplot-benchmarkresult"><i class="fa fa-check"></i><b>2.6.3</b> Plotting Benchmark Results</a></li>
<li class="chapter" data-level="2.6.4" data-path="benchmarking.html"><a href="benchmarking.html#bm-resamp"><i class="fa fa-check"></i><b>2.6.4</b> Extracting ResampleResults</a></li>
<li class="chapter" data-level="2.6.5" data-path="benchmarking.html"><a href="benchmarking.html#converting-and-merging-resampleresults"><i class="fa fa-check"></i><b>2.6.5</b> Converting and Merging ResampleResults</a></li>
</ul>
</li>
<li class="chapter" data-level="2.7" data-path="binary.html">
<a href="binary.html"><i class="fa fa-check"></i><b>2.7</b> Binary classification</a><ul>
<li class="chapter" data-level="2.7.1" data-path="binary.html"><a href="binary.html#binary-roc"><i class="fa fa-check"></i><b>2.7.1</b> ROC Curve and Thresholds</a></li>
<li class="chapter" data-level="2.7.2" data-path="binary.html"><a href="binary.html#threshold-tuning"><i class="fa fa-check"></i><b>2.7.2</b> Threshold Tuning</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="3" data-path="model-optim.html">
<a href="model-optim.html"><i class="fa fa-check"></i><b>3</b> Model Optimization</a><ul>
<li class="chapter" data-level="3.1" data-path="tuning.html">
<a href="tuning.html"><i class="fa fa-check"></i><b>3.1</b> Hyperparameter Tuning</a><ul>
<li class="chapter" data-level="3.1.1" data-path="tuning.html"><a href="tuning.html#tuning-optimization"><i class="fa fa-check"></i><b>3.1.1</b> The <code>TuningInstance</code> Class</a></li>
<li class="chapter" data-level="3.1.2" data-path="tuning.html"><a href="tuning.html#the-tuner-class"><i class="fa fa-check"></i><b>3.1.2</b> The <code>Tuner</code> Class</a></li>
<li class="chapter" data-level="3.1.3" data-path="tuning.html"><a href="tuning.html#tuning-triggering"><i class="fa fa-check"></i><b>3.1.3</b> Triggering the Tuning</a></li>
<li class="chapter" data-level="3.1.4" data-path="tuning.html"><a href="tuning.html#autotuner"><i class="fa fa-check"></i><b>3.1.4</b> Automating the Tuning</a></li>
</ul>
</li>
<li class="chapter" data-level="3.2" data-path="fs.html">
<a href="fs.html"><i class="fa fa-check"></i><b>3.2</b> Feature Selection / Filtering</a><ul>
<li class="chapter" data-level="3.2.1" data-path="fs.html"><a href="fs.html#fs-filter"><i class="fa fa-check"></i><b>3.2.1</b> Filters</a></li>
<li class="chapter" data-level="3.2.2" data-path="fs.html"><a href="fs.html#fs-calc"><i class="fa fa-check"></i><b>3.2.2</b> Calculating filter values</a></li>
<li class="chapter" data-level="3.2.3" data-path="fs.html"><a href="fs.html#fs-var-imp-filters"><i class="fa fa-check"></i><b>3.2.3</b> Variable Importance Filters</a></li>
<li class="chapter" data-level="3.2.4" data-path="fs.html"><a href="fs.html#fs-ensemble"><i class="fa fa-check"></i><b>3.2.4</b> Ensemble Methods</a></li>
<li class="chapter" data-level="3.2.5" data-path="fs.html"><a href="fs.html#fs-wrapper"><i class="fa fa-check"></i><b>3.2.5</b> Wrapper Methods</a></li>
</ul>
</li>
<li class="chapter" data-level="3.3" data-path="nested-resampling.html">
<a href="nested-resampling.html"><i class="fa fa-check"></i><b>3.3</b> Nested Resampling</a><ul>
<li class="chapter" data-level="3.3.1" data-path="nested-resampling.html"><a href="nested-resampling.html#nested-resamp-exec"><i class="fa fa-check"></i><b>3.3.1</b> Execution</a></li>
<li class="chapter" data-level="3.3.2" data-path="nested-resampling.html"><a href="nested-resampling.html#nested-resamp-eval"><i class="fa fa-check"></i><b>3.3.2</b> Evaluation</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="4" data-path="pipelines.html">
<a href="pipelines.html"><i class="fa fa-check"></i><b>4</b> Pipelines</a><ul>
<li class="chapter" data-level="4.1" data-path="the-building-blocks-pipeops.html"><a href="the-building-blocks-pipeops.html"><i class="fa fa-check"></i><b>4.1</b> The Building Blocks: PipeOps</a></li>
<li class="chapter" data-level="4.2" data-path="pipe-operator.html"><a href="pipe-operator.html"><i class="fa fa-check"></i><b>4.2</b> The Pipeline Operator: <code>%&gt;&gt;%</code></a></li>
<li class="chapter" data-level="4.3" data-path="pipe-nodes-edges-graphs.html"><a href="pipe-nodes-edges-graphs.html"><i class="fa fa-check"></i><b>4.3</b> Nodes, Edges and Graphs</a></li>
<li class="chapter" data-level="4.4" data-path="pipe-modeling.html">
<a href="pipe-modeling.html"><i class="fa fa-check"></i><b>4.4</b> Modeling</a><ul>
<li class="chapter" data-level="4.4.1" data-path="pipe-modeling.html"><a href="pipe-modeling.html#pipe-hyperpars"><i class="fa fa-check"></i><b>4.4.1</b> Setting Hyperparameters</a></li>
<li class="chapter" data-level="4.4.2" data-path="pipe-modeling.html"><a href="pipe-modeling.html#pipe-tuning"><i class="fa fa-check"></i><b>4.4.2</b> Tuning</a></li>
</ul>
</li>
<li class="chapter" data-level="4.5" data-path="pipe-nonlinear.html">
<a href="pipe-nonlinear.html"><i class="fa fa-check"></i><b>4.5</b> Non-Linear Graphs</a><ul>
<li class="chapter" data-level="4.5.1" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles-branching-copying"><i class="fa fa-check"></i><b>4.5.1</b> Branching &amp; Copying</a></li>
<li class="chapter" data-level="4.5.2" data-path="pipe-nonlinear.html">
<a href="pipe-nonlinear.html#pipe-model-ensembles"><i class="fa fa-check"></i><b>4.5.2</b> Model Ensembles</a><ul>
<li class="chapter" data-level="4.5.2.1" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles-bagging"><i class="fa fa-check"></i><b>4.5.2.1</b> Bagging</a></li>
<li class="chapter" data-level="4.5.2.2" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles-stacking"><i class="fa fa-check"></i><b>4.5.2.2</b> Stacking</a></li>
<li class="chapter" data-level="4.5.2.3" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#multilevel-stacking"><i class="fa fa-check"></i><b>4.5.2.3</b> Multilevel Stacking</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="4.6" data-path="pipe-special-ops.html">
<a href="pipe-special-ops.html"><i class="fa fa-check"></i><b>4.6</b> Special Operators</a><ul>
<li class="chapter" data-level="4.6.1" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#imputation-pipeopimpute"><i class="fa fa-check"></i><b>4.6.1</b> Imputation: <code>PipeOpImpute</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#feature-engineering-pipeopmutate"><i class="fa fa-check"></i><b>4.6.2</b> Feature Engineering: <code>PipeOpMutate</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#training-on-data-subsets-pipeopchunk"><i class="fa fa-check"></i><b>4.6.3</b> Training on data subsets: <code>PipeOpChunk</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#feature-selection-pipeopfilter-and-pipeopselect"><i class="fa fa-check"></i><b>4.6.4</b> Feature Selection: <code>PipeOpFilter</code> and <code>PipeOpSelect</code></a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="5" data-path="technical.html">
<a href="technical.html"><i class="fa fa-check"></i><b>5</b> Technical</a><ul>
<li class="chapter" data-level="5.1" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>5.1</b> Parallelization</a></li>
<li class="chapter" data-level="5.2" data-path="error-handling.html">
<a href="error-handling.html"><i class="fa fa-check"></i><b>5.2</b> Error Handling</a><ul>
<li class="chapter" data-level="5.2.1" data-path="error-handling.html"><a href="error-handling.html#encapsulation"><i class="fa fa-check"></i><b>5.2.1</b> Encapsulation</a></li>
<li class="chapter" data-level="5.2.2" data-path="error-handling.html"><a href="error-handling.html#fallback-learners"><i class="fa fa-check"></i><b>5.2.2</b> Fallback learners</a></li>
</ul>
</li>
<li class="chapter" data-level="5.3" data-path="backends.html">
<a href="backends.html"><i class="fa fa-check"></i><b>5.3</b> Database Backends</a><ul>
<li class="chapter" data-level="5.3.1" data-path="backends.html"><a href="backends.html#use-case-nyc-flights"><i class="fa fa-check"></i><b>5.3.1</b> Use Case: NYC Flights</a></li>
<li class="chapter" data-level="5.3.2" data-path="backends.html"><a href="backends.html#preprocessing-with-dplyr"><i class="fa fa-check"></i><b>5.3.2</b> Preprocessing with <code>dplyr</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="backends.html"><a href="backends.html#databackenddplyr"><i class="fa fa-check"></i><b>5.3.3</b> DataBackendDplyr</a></li>
<li class="chapter" data-level="5.3.4" data-path="backends.html"><a href="backends.html#model-fitting"><i class="fa fa-check"></i><b>5.3.4</b> Model fitting</a></li>
<li class="chapter" data-level="5.3.5" data-path="backends.html"><a href="backends.html#cleanup"><i class="fa fa-check"></i><b>5.3.5</b> Cleanup</a></li>
</ul>
</li>
<li class="chapter" data-level="5.4" data-path="paradox.html">
<a href="paradox.html"><i class="fa fa-check"></i><b>5.4</b> Parameters (using <code>paradox</code>)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="paradox.html"><a href="paradox.html#reference-based-objects"><i class="fa fa-check"></i><b>5.4.1</b> Reference Based Objects</a></li>
<li class="chapter" data-level="5.4.2" data-path="paradox.html">
<a href="paradox.html#defining-a-parameter-space"><i class="fa fa-check"></i><b>5.4.2</b> Defining a Parameter Space</a><ul>
<li class="chapter" data-level="5.4.2.1" data-path="paradox.html"><a href="paradox.html#single-parameters"><i class="fa fa-check"></i><b>5.4.2.1</b> Single Parameters</a></li>
<li class="chapter" data-level="5.4.2.2" data-path="paradox.html"><a href="paradox.html#parameter-sets"><i class="fa fa-check"></i><b>5.4.2.2</b> Parameter Sets</a></li>
<li class="chapter" data-level="5.4.2.3" data-path="paradox.html"><a href="paradox.html#vector-parameters"><i class="fa fa-check"></i><b>5.4.2.3</b> Vector Parameters</a></li>
</ul>
</li>
<li class="chapter" data-level="5.4.3" data-path="paradox.html">
<a href="paradox.html#parameter-sampling"><i class="fa fa-check"></i><b>5.4.3</b> Parameter Sampling</a><ul>
<li class="chapter" data-level="5.4.3.1" data-path="paradox.html"><a href="paradox.html#parameter-designs"><i class="fa fa-check"></i><b>5.4.3.1</b> Parameter Designs</a></li>
<li class="chapter" data-level="5.4.3.2" data-path="paradox.html"><a href="paradox.html#grid-design"><i class="fa fa-check"></i><b>5.4.3.2</b> Grid Design</a></li>
<li class="chapter" data-level="5.4.3.3" data-path="paradox.html"><a href="paradox.html#random-sampling"><i class="fa fa-check"></i><b>5.4.3.3</b> Random Sampling</a></li>
<li class="chapter" data-level="5.4.3.4" data-path="paradox.html"><a href="paradox.html#generalized-sampling-the-sampler-class"><i class="fa fa-check"></i><b>5.4.3.4</b> Generalized Sampling: The <code>Sampler</code> Class</a></li>
</ul>
</li>
<li class="chapter" data-level="5.4.4" data-path="paradox.html">
<a href="paradox.html#parameter-transformation"><i class="fa fa-check"></i><b>5.4.4</b> Parameter Transformation</a><ul>
<li class="chapter" data-level="5.4.4.1" data-path="paradox.html"><a href="paradox.html#transformation-between-types"><i class="fa fa-check"></i><b>5.4.4.1</b> Transformation between Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="5.5" data-path="logging.html">
<a href="logging.html"><i class="fa fa-check"></i><b>5.5</b> Logging and Verbosity</a><ul>
<li class="chapter" data-level="5.5.1" data-path="logging.html"><a href="logging.html#available-logging-levels"><i class="fa fa-check"></i><b>5.5.1</b> Available logging levels</a></li>
<li class="chapter" data-level="5.5.2" data-path="logging.html"><a href="logging.html#global-setting"><i class="fa fa-check"></i><b>5.5.2</b> Global Setting</a></li>
<li class="chapter" data-level="5.5.3" data-path="logging.html"><a href="logging.html#changing-mlr3-logging-levels"><i class="fa fa-check"></i><b>5.5.3</b> Changing mlr3 logging levels</a></li>
</ul>
</li>
<li class="chapter" data-level="5.6" data-path="transition.html"><a href="transition.html"><i class="fa fa-check"></i><b>5.6</b> mlr -&gt; mlr3 Transition Guide</a></li>
</ul>
</li>
<li class="chapter" data-level="6" data-path="extending.html">
<a href="extending.html"><i class="fa fa-check"></i><b>6</b> Extending</a><ul>
<li class="chapter" data-level="6.1" data-path="ext-learner.html">
<a href="ext-learner.html"><i class="fa fa-check"></i><b>6.1</b> Extending with Learners</a><ul>
<li class="chapter" data-level="6.1.1" data-path="ext-learner.html"><a href="ext-learner.html#learner-meta-information"><i class="fa fa-check"></i><b>6.1.1</b> Meta-information</a></li>
<li class="chapter" data-level="6.1.2" data-path="ext-learner.html"><a href="ext-learner.html#learner-train"><i class="fa fa-check"></i><b>6.1.2</b> Train function</a></li>
<li class="chapter" data-level="6.1.3" data-path="ext-learner.html"><a href="ext-learner.html#learner-predict"><i class="fa fa-check"></i><b>6.1.3</b> Predict function</a></li>
<li class="chapter" data-level="6.1.4" data-path="ext-learner.html"><a href="ext-learner.html#final-learner"><i class="fa fa-check"></i><b>6.1.4</b> Final learner</a></li>
</ul>
</li>
<li class="chapter" data-level="6.2" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html"><i class="fa fa-check"></i><b>6.2</b> Extending with mlr3pipelines</a><ul>
<li class="chapter" data-level="6.2.1" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html#ext-pipeopcopy"><i class="fa fa-check"></i><b>6.2.1</b> General Case Example: <code>PipeOpCopy</code></a><ul>
<li class="chapter" data-level="6.2.1.1" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#first-steps-inheriting-from-pipeop"><i class="fa fa-check"></i><b>6.2.1.1</b> First Steps: Inheriting from <code>PipeOp</code></a></li>
<li class="chapter" data-level="6.2.1.2" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#channel-definitions"><i class="fa fa-check"></i><b>6.2.1.2</b> Channel Definitions</a></li>
<li class="chapter" data-level="6.2.1.3" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#train-and-predict"><i class="fa fa-check"></i><b>6.2.1.3</b> Train and Predict</a></li>
<li class="chapter" data-level="6.2.1.4" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#putting-it-together"><i class="fa fa-check"></i><b>6.2.1.4</b> Putting it Together</a></li>
</ul>
</li>
<li class="chapter" data-level="6.2.2" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html#ext-pipe-preproc"><i class="fa fa-check"></i><b>6.2.2</b> Special Case: Preprocessing</a><ul>
<li class="chapter" data-level="6.2.2.1" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#example-pipeopdropna"><i class="fa fa-check"></i><b>6.2.2.1</b> Example: <code>PipeOpDropNA</code></a></li>
<li class="chapter" data-level="6.2.2.2" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#example-pipeopscalealways"><i class="fa fa-check"></i><b>6.2.2.2</b> Example: <code>PipeOpScaleAlways</code></a></li>
</ul>
</li>
<li class="chapter" data-level="6.2.3" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html#special-case-preprocessing-with-simple-train"><i class="fa fa-check"></i><b>6.2.3</b> Special Case: Preprocessing with Simple Train</a><ul>
<li class="chapter" data-level="6.2.3.1" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#example-pipeopdropconst"><i class="fa fa-check"></i><b>6.2.3.1</b> Example: <code>PipeOpDropConst</code></a></li>
<li class="chapter" data-level="6.2.3.2" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#example-pipeopscalealwayssimple"><i class="fa fa-check"></i><b>6.2.3.2</b> Example: <code>PipeOpScaleAlwaysSimple</code></a></li>
</ul>
</li>
<li class="chapter" data-level="6.2.4" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html#ext-pipe-hyperpars"><i class="fa fa-check"></i><b>6.2.4</b> Hyperparameters</a><ul>
<li class="chapter" data-level="6.2.4.1" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#hyperparameter-example-pipeopscale"><i class="fa fa-check"></i><b>6.2.4.1</b> Hyperparameter Example: <code>PipeOpScale</code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="7" data-path="special-tasks.html">
<a href="special-tasks.html"><i class="fa fa-check"></i><b>7</b> Special Tasks</a><ul>
<li class="chapter" data-level="7.1" data-path="survival.html"><a href="survival.html"><i class="fa fa-check"></i><b>7.1</b> Survival Analysis</a></li>
<li class="chapter" data-level="7.2" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>7.2</b> Spatial Analysis</a></li>
<li class="chapter" data-level="7.3" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i><b>7.3</b> Ordinal Analysis</a></li>
<li class="chapter" data-level="7.4" data-path="functional.html">
<a href="functional.html"><i class="fa fa-check"></i><b>7.4</b> Functional Analysis</a><ul>
<li class="chapter" data-level="7.4.1" data-path="functional.html"><a href="functional.html#how-to-model-functional-data"><i class="fa fa-check"></i><b>7.4.1</b> How to model functional data?</a></li>
</ul>
</li>
<li class="chapter" data-level="7.5" data-path="multilabel.html"><a href="multilabel.html"><i class="fa fa-check"></i><b>7.5</b> Multilabel Classification</a></li>
<li class="chapter" data-level="7.6" data-path="cost-sens.html">
<a href="cost-sens.html"><i class="fa fa-check"></i><b>7.6</b> Cost-Sensitive Classification</a><ul>
<li class="chapter" data-level="7.6.1" data-path="cost-sens.html"><a href="cost-sens.html#a-first-model"><i class="fa fa-check"></i><b>7.6.1</b> A First Model</a></li>
<li class="chapter" data-level="7.6.2" data-path="cost-sens.html"><a href="cost-sens.html#cost-sensitive-measure"><i class="fa fa-check"></i><b>7.6.2</b> Cost-sensitive Measure</a></li>
<li class="chapter" data-level="7.6.3" data-path="cost-sens.html"><a href="cost-sens.html#thresholding"><i class="fa fa-check"></i><b>7.6.3</b> Thresholding</a></li>
<li class="chapter" data-level="7.6.4" data-path="cost-sens.html"><a href="cost-sens.html#threshold-tuning-1"><i class="fa fa-check"></i><b>7.6.4</b> Threshold Tuning</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="8" data-path="interpretation.html">
<a href="interpretation.html"><i class="fa fa-check"></i><b>8</b> Model Interpretation</a><ul>
<li class="chapter" data-level="8.1" data-path="iml.html"><a href="iml.html"><i class="fa fa-check"></i><b>8.1</b> IML</a></li>
<li class="chapter" data-level="8.2" data-path="dalex.html"><a href="dalex.html"><i class="fa fa-check"></i><b>8.2</b> Dalex</a></li>
</ul>
</li>
<li class="chapter" data-level="9" data-path="use-cases.html">
<a href="use-cases.html"><i class="fa fa-check"></i><b>9</b> Use Cases</a><ul>
<li class="chapter" data-level="9.1" data-path="use-case-regr-houses.html">
<a href="use-case-regr-houses.html"><i class="fa fa-check"></i><b>9.1</b> House Price Prediction in King County</a><ul>
<li class="chapter" data-level="9.1.1" data-path="use-case-regr-houses.html">
<a href="use-case-regr-houses.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>9.1.1</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="9.1.1.1" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#distribution-of-the-price"><i class="fa fa-check"></i><b>9.1.1.1</b> Distribution of the price:</a></li>
<li class="chapter" data-level="9.1.1.2" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#association-between-variables"><i class="fa fa-check"></i><b>9.1.1.2</b> Association between variables</a></li>
</ul>
</li>
<li class="chapter" data-level="9.1.2" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#splitting-into-train-and-test-data"><i class="fa fa-check"></i><b>9.1.2</b> Splitting into train and test data</a></li>
<li class="chapter" data-level="9.1.3" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#a-first-model-decision-tree"><i class="fa fa-check"></i><b>9.1.3</b> A first model: Decision Tree</a></li>
<li class="chapter" data-level="9.1.4" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#a-first-baseline-decision-tree"><i class="fa fa-check"></i><b>9.1.4</b> A first baseline: Decision Tree</a></li>
<li class="chapter" data-level="9.1.5" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#many-trees-random-forest"><i class="fa fa-check"></i><b>9.1.5</b> Many Trees: Random Forest</a></li>
<li class="chapter" data-level="9.1.6" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#a-better-baseline-autotuner"><i class="fa fa-check"></i><b>9.1.6</b> A better baseline: <code>AutoTuner</code></a></li>
<li class="chapter" data-level="9.1.7" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#engineering-features-mutating-zip-codes"><i class="fa fa-check"></i><b>9.1.7</b> Engineering Features: Mutating ZIP-Codes</a></li>
<li class="chapter" data-level="9.1.8" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#obtaining-a-sparser-model"><i class="fa fa-check"></i><b>9.1.8</b> Obtaining a sparser model</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="10" data-path="appendix.html">
<a href="appendix.html"><i class="fa fa-check"></i><b>10</b> Appendix</a><ul>
<li class="chapter" data-level="10.1" data-path="list-learners.html"><a href="list-learners.html"><i class="fa fa-check"></i><b>10.1</b> Integrated Learners</a></li>
<li class="chapter" data-level="10.2" data-path="list-measures.html"><a href="list-measures.html"><i class="fa fa-check"></i><b>10.2</b> Integrated Performance Measures</a></li>
<li class="chapter" data-level="10.3" data-path="list-filters.html">
<a href="list-filters.html"><i class="fa fa-check"></i><b>10.3</b> Integrated Filter Methods</a><ul>
<li class="chapter" data-level="10.3.1" data-path="list-filters.html"><a href="list-filters.html#fs-filter-list"><i class="fa fa-check"></i><b>10.3.1</b> Standalone filter methods</a></li>
<li class="chapter" data-level="10.3.2" data-path="list-filters.html"><a href="list-filters.html#fs-filter-embedded-list"><i class="fa fa-check"></i><b>10.3.2</b> Algorithms With Embedded Filter Methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider">
<li><a href="./">Made with <i class="fas fa-heart"></i> for open-source </a></li>

</ul></nav>
</div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">mlr3 manual <img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" width="50"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-"><div id="error-handling" class="section level2">
<h2>
<span class="header-section-number">5.2</span> Error Handling</h2>
<p>To demonstrate how to properly deal with misbehaving learners, <a href="https://github.com/mlr-org/mlr3"><code>mlr3</code></a> ships with the learner <a href="https://mlr3.mlr-org.com/reference/mlr_learners_classif.debug.html"><code>classif.debug</code></a>:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1">task =<span class="st"> </span><span class="kw">tsk</span>(<span class="st">"iris"</span>)</a>
<a class="sourceLine" id="cb146-2" data-line-number="2">learner =<span class="st"> </span><span class="kw">lrn</span>(<span class="st">"classif.debug"</span>)</a>
<a class="sourceLine" id="cb146-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(learner)</a>
<a class="sourceLine" id="cb146-4" data-line-number="4">## &lt;LearnerClassifDebug:classif.debug&gt;</a>
<a class="sourceLine" id="cb146-5" data-line-number="5">## * Model: -</a>
<a class="sourceLine" id="cb146-6" data-line-number="6">## * Parameters: list()</a>
<a class="sourceLine" id="cb146-7" data-line-number="7">## * Packages: -</a>
<a class="sourceLine" id="cb146-8" data-line-number="8">## * Predict Type: response</a>
<a class="sourceLine" id="cb146-9" data-line-number="9">## * Feature types: logical, integer, numeric, character, factor, ordered</a>
<a class="sourceLine" id="cb146-10" data-line-number="10">## * Properties: missings, multiclass, twoclass</a></code></pre></div>
<p>This learner comes with special hyperparameters that let us control</p>
<ol style="list-style-type: decimal">
<li>what conditions should be signaled (message, warning, error, segfault) with what probability,</li>
<li>during which stage the conditions should be signaled (train or predict), and</li>
<li>the ratio of predictions being <code>NA</code> (<code>predict_missing</code>).</li>
</ol>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1">learner<span class="op">$</span>param_set</a>
<a class="sourceLine" id="cb147-2" data-line-number="2">## ParamSet: </a>
<a class="sourceLine" id="cb147-3" data-line-number="3">##                   id    class lower upper      levels     default value</a>
<a class="sourceLine" id="cb147-4" data-line-number="4">##  1:    message_train ParamDbl     0     1                       0      </a>
<a class="sourceLine" id="cb147-5" data-line-number="5">##  2:  message_predict ParamDbl     0     1                       0      </a>
<a class="sourceLine" id="cb147-6" data-line-number="6">##  3:    warning_train ParamDbl     0     1                       0      </a>
<a class="sourceLine" id="cb147-7" data-line-number="7">##  4:  warning_predict ParamDbl     0     1                       0      </a>
<a class="sourceLine" id="cb147-8" data-line-number="8">##  5:      error_train ParamDbl     0     1                       0      </a>
<a class="sourceLine" id="cb147-9" data-line-number="9">##  6:    error_predict ParamDbl     0     1                       0      </a>
<a class="sourceLine" id="cb147-10" data-line-number="10">##  7:   segfault_train ParamDbl     0     1                       0      </a>
<a class="sourceLine" id="cb147-11" data-line-number="11">##  8: segfault_predict ParamDbl     0     1                       0      </a>
<a class="sourceLine" id="cb147-12" data-line-number="12">##  9:  predict_missing ParamDbl     0     1                       0      </a>
<a class="sourceLine" id="cb147-13" data-line-number="13">## 10:       save_tasks ParamLgl    NA    NA  TRUE,FALSE       FALSE      </a>
<a class="sourceLine" id="cb147-14" data-line-number="14">## 11:                x ParamDbl     0     1             &lt;NoDefault&gt;</a></code></pre></div>
<p>With the learner’s default settings, the learner will do nothing special: The learner learns a random label and creates constant predictions.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1">task =<span class="st"> </span><span class="kw">tsk</span>(<span class="st">"iris"</span>)</a>
<a class="sourceLine" id="cb148-2" data-line-number="2">learner<span class="op">$</span><span class="kw">train</span>(task)<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(task)<span class="op">$</span>confusion</a>
<a class="sourceLine" id="cb148-3" data-line-number="3">##             truth</a>
<a class="sourceLine" id="cb148-4" data-line-number="4">## response     setosa versicolor virginica</a>
<a class="sourceLine" id="cb148-5" data-line-number="5">##   setosa         50         50        50</a>
<a class="sourceLine" id="cb148-6" data-line-number="6">##   versicolor      0          0         0</a>
<a class="sourceLine" id="cb148-7" data-line-number="7">##   virginica       0          0         0</a></code></pre></div>
<p>We now set a hyperparameter to let the debug learner signal an error during the train step.
By default,<a href="https://github.com/mlr-org/mlr3"><code>mlr3</code></a> does not catch conditions such as warnings or errors raised by third-party code like learners:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1">learner<span class="op">$</span>param_set<span class="op">$</span>values =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">error_train =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb149-2" data-line-number="2">learner<span class="op">$</span><span class="kw">train</span>(<span class="kw">tsk</span>(<span class="st">"iris"</span>))</a>
<a class="sourceLine" id="cb149-3" data-line-number="3">## Error in learner$train_internal(task = task): Error from classif.debug-&gt;train()</a></code></pre></div>
<p>If this would be a regular learner, we could now start debugging with <a href="https://www.rdocumentation.org/packages/base/topics/traceback"><code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code></a> (or create a <a href="https://stackoverflow.com/help/minimal-reproducible-example">MRE</a> to file a bug report).</p>
<p>However, machine learning algorithms raising errors is not uncommon as algorithms typically cannot process all possible data.
Thus, we need a mechanism to</p>
<ol style="list-style-type: decimal">
<li>capture all signaled conditions such as messages, warnings and errors so that we can analyze them post-hoc, and</li>
<li>a statistically sound way to proceed the calculation and be able to aggregate over partial results.</li>
</ol>
<p>These two mechanisms are explained in the following subsections.</p>
<div id="encapsulation" class="section level3">
<h3>
<span class="header-section-number">5.2.1</span> Encapsulation</h3>
<p>With encapsulation, exceptions do not stop the program flow and all output is logged to the learner (instead of printed to the console).
Each <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> has a field <code>encapsulate</code> to control how the train or predict steps are executed.
One way to encapsulate the execution is provided by the package <a href="https://cran.r-project.org/package=evaluate">evaluate</a> (see <a href="https://mlr3misc.mlr-org.com/reference/encapsulate.html"><code>encapsulate()</code></a> for more details):</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1">task =<span class="st"> </span><span class="kw">tsk</span>(<span class="st">"iris"</span>)</a>
<a class="sourceLine" id="cb150-2" data-line-number="2">learner =<span class="st"> </span><span class="kw">lrn</span>(<span class="st">"classif.debug"</span>)</a>
<a class="sourceLine" id="cb150-3" data-line-number="3">learner<span class="op">$</span>param_set<span class="op">$</span>values =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">warning_train =</span> <span class="dv">1</span>, <span class="dt">error_train =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb150-4" data-line-number="4">learner<span class="op">$</span>encapsulate =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">train =</span> <span class="st">"evaluate"</span>, <span class="dt">predict =</span> <span class="st">"evaluate"</span>)</a>
<a class="sourceLine" id="cb150-5" data-line-number="5"></a>
<a class="sourceLine" id="cb150-6" data-line-number="6">learner<span class="op">$</span><span class="kw">train</span>(task)</a></code></pre></div>
<p>After training the learner, one can access the recorded log via the fields <code>log</code>, <code>warnings</code> and <code>errors</code>:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1">learner<span class="op">$</span>log</a>
<a class="sourceLine" id="cb151-2" data-line-number="2">##    stage   class                                 msg</a>
<a class="sourceLine" id="cb151-3" data-line-number="3">## 1: train warning Warning from classif.debug-&gt;train()</a>
<a class="sourceLine" id="cb151-4" data-line-number="4">## 2: train   error   Error from classif.debug-&gt;train()</a>
<a class="sourceLine" id="cb151-5" data-line-number="5">learner<span class="op">$</span>warnings</a>
<a class="sourceLine" id="cb151-6" data-line-number="6">## [1] "Warning from classif.debug-&gt;train()"</a>
<a class="sourceLine" id="cb151-7" data-line-number="7">learner<span class="op">$</span>errors</a>
<a class="sourceLine" id="cb151-8" data-line-number="8">## [1] "Error from classif.debug-&gt;train()"</a></code></pre></div>
<p>Another method for encapsulation is implemented in the <a href="https://cran.r-project.org/package=callr">callr</a> package.
<a href="https://cran.r-project.org/package=callr">callr</a> spawns a new R process to execute the respective step, and thus even guards the current session from segfaults.
On the downside, starting new processes comes with a computational overhead.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1">learner<span class="op">$</span>encapsulate =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">train =</span> <span class="st">"callr"</span>, <span class="dt">predict =</span> <span class="st">"callr"</span>)</a>
<a class="sourceLine" id="cb152-2" data-line-number="2">learner<span class="op">$</span>param_set<span class="op">$</span>values =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">segfault_train =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb152-3" data-line-number="3">learner<span class="op">$</span><span class="kw">train</span>(<span class="dt">task =</span> task)</a>
<a class="sourceLine" id="cb152-4" data-line-number="4">learner<span class="op">$</span>errors</a>
<a class="sourceLine" id="cb152-5" data-line-number="5">## [1] "callr process exited with status -11"</a></code></pre></div>
<p>Without a model, it is not possible to get predictions though:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1">learner<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(task)</a>
<a class="sourceLine" id="cb153-2" data-line-number="2">## Error: Cannot predict, Learner 'classif.debug' has not been trained yet</a></code></pre></div>
<p>To handle the missing predictions in a graceful way during <a href="https://mlr3.mlr-org.com/reference/resample.html"><code>resample()</code></a> or <a href="https://mlr3.mlr-org.com/reference/benchmark.html"><code>benchmark()</code></a>, fallback learners are introduced next.</p>
</div>
<div id="fallback-learners" class="section level3">
<h3>
<span class="header-section-number">5.2.2</span> Fallback learners</h3>
<p>Fallback learners have the purpose to allow scoring results in cases where a <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> is misbehaving in some sense.
Some typical examples include:</p>
<ul>
<li>The learner fails to fit a model during training, e.g., if some convergence criterion is not met or the learner ran out of memory.</li>
<li>The learner fails to predict for some or all observations.
A typical case is e.g. new factor levels in the test data.</li>
</ul>
<p>We first handle the most common case that a learner completely breaks while fitting a model or while predicting on new data.
If the learner fails in either of these two steps, we rely on a second learner to generate predictions: the fallback learner.</p>
<p>In the next example, in addition to the debug learner, we attach a simple featureless learner to the debug learner.
So whenever the debug learner fails (which is every time with the given parametrization) and encapsulation in enabled, <code>mlr3</code> falls back to the predictions of the featureless learner internally:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1">task =<span class="st"> </span><span class="kw">tsk</span>(<span class="st">"iris"</span>)</a>
<a class="sourceLine" id="cb154-2" data-line-number="2">learner =<span class="st"> </span><span class="kw">lrn</span>(<span class="st">"classif.debug"</span>)</a>
<a class="sourceLine" id="cb154-3" data-line-number="3">learner<span class="op">$</span>param_set<span class="op">$</span>values =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">error_train =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb154-4" data-line-number="4">learner<span class="op">$</span>encapsulate =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">train =</span> <span class="st">"evaluate"</span>)</a>
<a class="sourceLine" id="cb154-5" data-line-number="5">learner<span class="op">$</span>fallback =<span class="st"> </span><span class="kw">lrn</span>(<span class="st">"classif.featureless"</span>)</a>
<a class="sourceLine" id="cb154-6" data-line-number="6">learner<span class="op">$</span><span class="kw">train</span>(task)</a>
<a class="sourceLine" id="cb154-7" data-line-number="7">learner</a>
<a class="sourceLine" id="cb154-8" data-line-number="8">## &lt;LearnerClassifDebug:classif.debug&gt;</a>
<a class="sourceLine" id="cb154-9" data-line-number="9">## * Model: -</a>
<a class="sourceLine" id="cb154-10" data-line-number="10">## * Parameters: error_train=1</a>
<a class="sourceLine" id="cb154-11" data-line-number="11">## * Packages: -</a>
<a class="sourceLine" id="cb154-12" data-line-number="12">## * Predict Type: response</a>
<a class="sourceLine" id="cb154-13" data-line-number="13">## * Feature types: logical, integer, numeric, character, factor, ordered</a>
<a class="sourceLine" id="cb154-14" data-line-number="14">## * Properties: missings, multiclass, twoclass</a>
<a class="sourceLine" id="cb154-15" data-line-number="15">## * Errors: Error from classif.debug-&gt;train()</a></code></pre></div>
<p>Note that the log contains the captured error (which is also included in the print output), and although we don’t have a model, we can still get predictions:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1">learner<span class="op">$</span>model</a>
<a class="sourceLine" id="cb155-2" data-line-number="2">## NULL</a>
<a class="sourceLine" id="cb155-3" data-line-number="3">prediction =<span class="st"> </span>learner<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(task)</a>
<a class="sourceLine" id="cb155-4" data-line-number="4">prediction<span class="op">$</span><span class="kw">score</span>()</a>
<a class="sourceLine" id="cb155-5" data-line-number="5">## classif.ce </a>
<a class="sourceLine" id="cb155-6" data-line-number="6">##     0.6667</a></code></pre></div>
<p>While the fallback learner is of limited use for this stepwise train-predict procedure, it is invaluable for larger benchmark studies where only few resampling iterations are failing.
Here, we need to replace the missing scores with a number in order to aggregate over all resampling iterations.
And imputing a number which is equivalent to guessing labels often seems to be the right amount of penalization.</p>
<p>In the following snippet we compare the previously created debug learner with a simple classification tree.
We re-parametrize the debug learner to fail in roughly 30% of the resampling iterations during the training step:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1">learner<span class="op">$</span>param_set<span class="op">$</span>values =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">error_train =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb156-2" data-line-number="2"></a>
<a class="sourceLine" id="cb156-3" data-line-number="3">bmr =<span class="st"> </span><span class="kw">benchmark</span>(<span class="kw">benchmark_grid</span>(<span class="kw">tsk</span>(<span class="st">"iris"</span>), <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(learner, <span class="kw">lrn</span>(<span class="st">"classif.rpart"</span>)), <span class="kw">rsmp</span>(<span class="st">"cv"</span>)))</a>
<a class="sourceLine" id="cb156-4" data-line-number="4">aggr =<span class="st"> </span>bmr<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="dt">conditions =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb156-5" data-line-number="5">aggr</a>
<a class="sourceLine" id="cb156-6" data-line-number="6">##    nr  resample_result task_id    learner_id resampling_id iters warnings</a>
<a class="sourceLine" id="cb156-7" data-line-number="7">## 1:  1 &lt;ResampleResult&gt;    iris classif.debug            cv    10        0</a>
<a class="sourceLine" id="cb156-8" data-line-number="8">## 2:  2 &lt;ResampleResult&gt;    iris classif.rpart            cv    10        0</a>
<a class="sourceLine" id="cb156-9" data-line-number="9">##    errors classif.ce</a>
<a class="sourceLine" id="cb156-10" data-line-number="10">## 1:      3     0.6733</a>
<a class="sourceLine" id="cb156-11" data-line-number="11">## 2:      0     0.0600</a></code></pre></div>
<p>To further investigate the errors, we can extract the <a href="https://mlr3.mlr-org.com/reference/ResampleResult.html"><code>ResampleResult</code></a>:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1">rr =<span class="st"> </span>aggr[learner_id <span class="op">==</span><span class="st"> "classif.debug"</span>]<span class="op">$</span>resample_result[[1L]]</a>
<a class="sourceLine" id="cb157-2" data-line-number="2">rr<span class="op">$</span>errors</a>
<a class="sourceLine" id="cb157-3" data-line-number="3">##    iteration                               msg</a>
<a class="sourceLine" id="cb157-4" data-line-number="4">## 1:         1 Error from classif.debug-&gt;train()</a>
<a class="sourceLine" id="cb157-5" data-line-number="5">## 2:         3 Error from classif.debug-&gt;train()</a>
<a class="sourceLine" id="cb157-6" data-line-number="6">## 3:         9 Error from classif.debug-&gt;train()</a></code></pre></div>
<p>A similar yet different problem emerges when a learner predicts only a subset of the observations in the test set (and predicts <code>NA</code> for others).
Handling such predictions in a statistically sound way is not straight-forward and a common source for over-optimism when reporting results.
Imagine that our goal is to benchmark two algorithms using a 10-fold cross validation on some binary classification task:</p>
<ul>
<li>Algorithm A is a ordinary logistic regression.</li>
<li>Algorithm B is also a ordinary logistic regression, but with a twist:
If the logistic regression is rather certain about the predicted label (&gt; 90% probability), it returns the label and a missing value otherwise.</li>
</ul>
<p>When comparing the performance of these two algorithms, it is obviously not fair to average over all predictions of algorithm A while only average over the “easy-to-predict” observations for algorithm B.
By doing so, algorithm B would easily outperform algorithm A, but you have not factored in that you can not generate predictions for many observations.
On the other hand, it is also not feasible to exclude all observations from the test set of a benchmark study where at least one algorithm failed to predict a label.
Instead, we proceed by imputing all missing predictions with something naive, e.g., by predicting the majority class with a featureless learner.
And as the majority class may depend on the resampling split (or we opt for some other arbitrary baseline learner), it is best to just train a second learner on the same resampling split.</p>
<p>Long story short, if a fallback learner is involved, missing predictions of the base learner will be automatically replaced with predictions from the fallback learner.
This is illustrated in the following example:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1">task =<span class="st"> </span><span class="kw">tsk</span>(<span class="st">"iris"</span>)</a>
<a class="sourceLine" id="cb158-2" data-line-number="2">learner =<span class="st"> </span><span class="kw">lrn</span>(<span class="st">"classif.debug"</span>)</a>
<a class="sourceLine" id="cb158-3" data-line-number="3"></a>
<a class="sourceLine" id="cb158-4" data-line-number="4"><span class="co"># this hyperparameter sets the ratio of missing predictions</span></a>
<a class="sourceLine" id="cb158-5" data-line-number="5">learner<span class="op">$</span>param_set<span class="op">$</span>values =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">predict_missing =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb158-6" data-line-number="6"></a>
<a class="sourceLine" id="cb158-7" data-line-number="7"><span class="co"># without fallback</span></a>
<a class="sourceLine" id="cb158-8" data-line-number="8">p =<span class="st"> </span>learner<span class="op">$</span><span class="kw">train</span>(task)<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(task)</a>
<a class="sourceLine" id="cb158-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(p<span class="op">$</span>response, <span class="dt">useNA =</span> <span class="st">"always"</span>)</a>
<a class="sourceLine" id="cb158-10" data-line-number="10">## </a>
<a class="sourceLine" id="cb158-11" data-line-number="11">##     setosa versicolor  virginica       &lt;NA&gt; </a>
<a class="sourceLine" id="cb158-12" data-line-number="12">##          0          0         75         75</a>
<a class="sourceLine" id="cb158-13" data-line-number="13"></a>
<a class="sourceLine" id="cb158-14" data-line-number="14"><span class="co"># with fallback</span></a>
<a class="sourceLine" id="cb158-15" data-line-number="15">learner<span class="op">$</span>fallback =<span class="st"> </span><span class="kw">lrn</span>(<span class="st">"classif.featureless"</span>)</a>
<a class="sourceLine" id="cb158-16" data-line-number="16">p =<span class="st"> </span>learner<span class="op">$</span><span class="kw">train</span>(task)<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(task)</a>
<a class="sourceLine" id="cb158-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(p<span class="op">$</span>response, <span class="dt">useNA =</span> <span class="st">"always"</span>)</a>
<a class="sourceLine" id="cb158-18" data-line-number="18">## </a>
<a class="sourceLine" id="cb158-19" data-line-number="19">##     setosa versicolor  virginica       &lt;NA&gt; </a>
<a class="sourceLine" id="cb158-20" data-line-number="20">##          0        150          0          0</a></code></pre></div>
<p>Summed up, by combining encapsulation and fallback learners, it is possible to benchmark even quite unreliable or instable learning algorithms in a convenient way.</p>
</div>
</div>
            </section>
</div>
        </div>
      </div>
<a href="parallelization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="backends.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script><script src="libs/gitbook-2.6.7/js/lunr.js"></script><script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script><script src="libs/gitbook-2.6.7/js/plugin-search.js"></script><script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script><script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script><script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script><script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script><script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script><script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mlr-org/mlr3book/edit/master/bookdown/05-technical.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/mlr-org/mlr3book/commits/master/05-technical.Rmd",
"text": "Edit history"
},
"view": {
"link": null,
"text": null
},
"download": [["mlr3book.pdf", "PDF"], ["mlr3book-pinp.pdf", "pinp-PDF"]],
"toc": {
"collapse": "section"
}
});
});
</script><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
