<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>2.4 Train and Predict | mlr3 manual</title>
<meta name="description" content="2.4 Train and Predict | mlr3 manual ">
<meta name="generator" content="bookdown 0.16 and GitBook 2.6.7">
<meta property="og:title" content="2.4 Train and Predict | mlr3 manual">
<meta property="og:type" content="book">
<meta property="og:url" content="https://mlr3book.mlr-org.com">
<meta name="github-repo" content="mlr-org/mlr3book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2.4 Train and Predict | mlr3 manual">
<meta name="author" content="The mlr-org Team">
<meta name="date" content="2019-12-24">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="prev" href="learners.html">
<link rel="next" href="resampling.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script><link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet">
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation"><ul class="summary">
<li><a href="./">mlr3 Manual <img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" width="30"></a></li>

<li class="divider">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Quickstart</a></li>
<li class="chapter" data-level="1" data-path="introduction-and-overview.html"><a href="introduction-and-overview.html"><i class="fa fa-check"></i><b>1</b> Introduction and Overview</a></li>
<li class="chapter" data-level="2" data-path="basics.html">
<a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basics</a><ul>
<li class="chapter" data-level="2.1" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>2.1</b> Quick R6 Intro for Beginners</a></li>
<li class="chapter" data-level="2.2" data-path="tasks.html">
<a href="tasks.html"><i class="fa fa-check"></i><b>2.2</b> Tasks</a><ul>
<li class="chapter" data-level="2.2.1" data-path="tasks.html"><a href="tasks.html#tasks-types"><i class="fa fa-check"></i><b>2.2.1</b> Task Types</a></li>
<li class="chapter" data-level="2.2.2" data-path="tasks.html"><a href="tasks.html#tasks-creation"><i class="fa fa-check"></i><b>2.2.2</b> Task Creation</a></li>
<li class="chapter" data-level="2.2.3" data-path="tasks.html"><a href="tasks.html#tasks-predefined"><i class="fa fa-check"></i><b>2.2.3</b> Predefined tasks</a></li>
<li class="chapter" data-level="2.2.4" data-path="tasks.html">
<a href="tasks.html#tasks-api"><i class="fa fa-check"></i><b>2.2.4</b> Task API</a><ul>
<li class="chapter" data-level="2.2.4.1" data-path="tasks.html"><a href="tasks.html#tasks-retrieving"><i class="fa fa-check"></i><b>2.2.4.1</b> Retrieving Data</a></li>
<li class="chapter" data-level="2.2.4.2" data-path="tasks.html"><a href="tasks.html#tasks-roles"><i class="fa fa-check"></i><b>2.2.4.2</b> Roles (Rows and Columns)</a></li>
<li class="chapter" data-level="2.2.4.3" data-path="tasks.html"><a href="tasks.html#tasks-mutators"><i class="fa fa-check"></i><b>2.2.4.3</b> Task Mutators</a></li>
</ul>
</li>
<li class="chapter" data-level="2.2.5" data-path="tasks.html"><a href="tasks.html#autoplot-task"><i class="fa fa-check"></i><b>2.2.5</b> Plotting Tasks</a></li>
</ul>
</li>
<li class="chapter" data-level="2.3" data-path="learners.html">
<a href="learners.html"><i class="fa fa-check"></i><b>2.3</b> Learners</a><ul>
<li class="chapter" data-level="2.3.1" data-path="learners.html"><a href="learners.html#learners-predefined"><i class="fa fa-check"></i><b>2.3.1</b> Predefined Learners</a></li>
</ul>
</li>
<li class="chapter" data-level="2.4" data-path="train-predict.html">
<a href="train-predict.html"><i class="fa fa-check"></i><b>2.4</b> Train and Predict</a><ul>
<li class="chapter" data-level="2.4.1" data-path="train-predict.html"><a href="train-predict.html#train-predict-objects"><i class="fa fa-check"></i><b>2.4.1</b> Creating Task and Learner Objects</a></li>
<li class="chapter" data-level="2.4.2" data-path="train-predict.html"><a href="train-predict.html#split-data"><i class="fa fa-check"></i><b>2.4.2</b> Setting up the train/test splits of the data</a></li>
<li class="chapter" data-level="2.4.3" data-path="train-predict.html"><a href="train-predict.html#training"><i class="fa fa-check"></i><b>2.4.3</b> Training the learner</a></li>
<li class="chapter" data-level="2.4.4" data-path="train-predict.html"><a href="train-predict.html#predicting"><i class="fa fa-check"></i><b>2.4.4</b> Predicting</a></li>
<li class="chapter" data-level="2.4.5" data-path="train-predict.html"><a href="train-predict.html#predict-type"><i class="fa fa-check"></i><b>2.4.5</b> Changing the Predict Type</a></li>
<li class="chapter" data-level="2.4.6" data-path="train-predict.html"><a href="train-predict.html#autoplot-prediction"><i class="fa fa-check"></i><b>2.4.6</b> Plotting Predictions</a></li>
<li class="chapter" data-level="2.4.7" data-path="train-predict.html"><a href="train-predict.html#measure"><i class="fa fa-check"></i><b>2.4.7</b> Performance assessment</a></li>
</ul>
</li>
<li class="chapter" data-level="2.5" data-path="resampling.html">
<a href="resampling.html"><i class="fa fa-check"></i><b>2.5</b> Resampling</a><ul>
<li class="chapter" data-level="2.5.1" data-path="resampling.html"><a href="resampling.html#resamp-settings"><i class="fa fa-check"></i><b>2.5.1</b> Settings</a></li>
<li class="chapter" data-level="2.5.2" data-path="resampling.html"><a href="resampling.html#resampling-inst"><i class="fa fa-check"></i><b>2.5.2</b> Instantiation</a></li>
<li class="chapter" data-level="2.5.3" data-path="resampling.html"><a href="resampling.html#resampling-exec"><i class="fa fa-check"></i><b>2.5.3</b> Execution</a></li>
<li class="chapter" data-level="2.5.4" data-path="resampling.html"><a href="resampling.html#resamp-custom"><i class="fa fa-check"></i><b>2.5.4</b> Custom resampling</a></li>
<li class="chapter" data-level="2.5.5" data-path="resampling.html"><a href="resampling.html#autoplot-resampleresult"><i class="fa fa-check"></i><b>2.5.5</b> Plotting Resample Results</a></li>
</ul>
</li>
<li class="chapter" data-level="2.6" data-path="benchmarking.html">
<a href="benchmarking.html"><i class="fa fa-check"></i><b>2.6</b> Benchmarking</a><ul>
<li class="chapter" data-level="2.6.1" data-path="benchmarking.html"><a href="benchmarking.html#bm-design"><i class="fa fa-check"></i><b>2.6.1</b> Design Creation</a></li>
<li class="chapter" data-level="2.6.2" data-path="benchmarking.html"><a href="benchmarking.html#bm-exec"><i class="fa fa-check"></i><b>2.6.2</b> Execution and Aggregation of Results</a></li>
<li class="chapter" data-level="2.6.3" data-path="benchmarking.html"><a href="benchmarking.html#autoplot-benchmarkresult"><i class="fa fa-check"></i><b>2.6.3</b> Plotting Benchmark Results</a></li>
<li class="chapter" data-level="2.6.4" data-path="benchmarking.html"><a href="benchmarking.html#bm-resamp"><i class="fa fa-check"></i><b>2.6.4</b> Extracting ResampleResults</a></li>
<li class="chapter" data-level="2.6.5" data-path="benchmarking.html"><a href="benchmarking.html#converting-and-merging-resampleresults"><i class="fa fa-check"></i><b>2.6.5</b> Converting and Merging ResampleResults</a></li>
</ul>
</li>
<li class="chapter" data-level="2.7" data-path="binary.html">
<a href="binary.html"><i class="fa fa-check"></i><b>2.7</b> Binary classification</a><ul>
<li class="chapter" data-level="2.7.1" data-path="binary.html"><a href="binary.html#binary-roc"><i class="fa fa-check"></i><b>2.7.1</b> ROC Curve and Thresholds</a></li>
<li class="chapter" data-level="2.7.2" data-path="binary.html"><a href="binary.html#threshold-tuning"><i class="fa fa-check"></i><b>2.7.2</b> Threshold Tuning</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="3" data-path="model-optim.html">
<a href="model-optim.html"><i class="fa fa-check"></i><b>3</b> Model Optimization</a><ul>
<li class="chapter" data-level="3.1" data-path="tuning.html">
<a href="tuning.html"><i class="fa fa-check"></i><b>3.1</b> Hyperparameter Tuning</a><ul>
<li class="chapter" data-level="3.1.1" data-path="tuning.html"><a href="tuning.html#tuning-optimization"><i class="fa fa-check"></i><b>3.1.1</b> The <code>TuningInstance</code> Class</a></li>
<li class="chapter" data-level="3.1.2" data-path="tuning.html"><a href="tuning.html#the-tuner-class"><i class="fa fa-check"></i><b>3.1.2</b> The <code>Tuner</code> Class</a></li>
<li class="chapter" data-level="3.1.3" data-path="tuning.html"><a href="tuning.html#tuning-triggering"><i class="fa fa-check"></i><b>3.1.3</b> Triggering the Tuning</a></li>
<li class="chapter" data-level="3.1.4" data-path="tuning.html"><a href="tuning.html#autotuner"><i class="fa fa-check"></i><b>3.1.4</b> Automating the Tuning</a></li>
</ul>
</li>
<li class="chapter" data-level="3.2" data-path="fs.html">
<a href="fs.html"><i class="fa fa-check"></i><b>3.2</b> Feature Selection / Filtering</a><ul>
<li class="chapter" data-level="3.2.1" data-path="fs.html"><a href="fs.html#fs-filter"><i class="fa fa-check"></i><b>3.2.1</b> Filters</a></li>
<li class="chapter" data-level="3.2.2" data-path="fs.html"><a href="fs.html#fs-calc"><i class="fa fa-check"></i><b>3.2.2</b> Calculating filter values</a></li>
<li class="chapter" data-level="3.2.3" data-path="fs.html"><a href="fs.html#fs-var-imp-filters"><i class="fa fa-check"></i><b>3.2.3</b> Variable Importance Filters</a></li>
<li class="chapter" data-level="3.2.4" data-path="fs.html"><a href="fs.html#fs-ensemble"><i class="fa fa-check"></i><b>3.2.4</b> Ensemble Methods</a></li>
<li class="chapter" data-level="3.2.5" data-path="fs.html"><a href="fs.html#fs-wrapper"><i class="fa fa-check"></i><b>3.2.5</b> Wrapper Methods</a></li>
</ul>
</li>
<li class="chapter" data-level="3.3" data-path="nested-resampling.html">
<a href="nested-resampling.html"><i class="fa fa-check"></i><b>3.3</b> Nested Resampling</a><ul>
<li class="chapter" data-level="3.3.1" data-path="nested-resampling.html"><a href="nested-resampling.html#nested-resamp-exec"><i class="fa fa-check"></i><b>3.3.1</b> Execution</a></li>
<li class="chapter" data-level="3.3.2" data-path="nested-resampling.html"><a href="nested-resampling.html#nested-resamp-eval"><i class="fa fa-check"></i><b>3.3.2</b> Evaluation</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="4" data-path="pipelines.html">
<a href="pipelines.html"><i class="fa fa-check"></i><b>4</b> Pipelines</a><ul>
<li class="chapter" data-level="4.1" data-path="the-building-blocks-pipeops.html"><a href="the-building-blocks-pipeops.html"><i class="fa fa-check"></i><b>4.1</b> The Building Blocks: PipeOps</a></li>
<li class="chapter" data-level="4.2" data-path="pipe-operator.html"><a href="pipe-operator.html"><i class="fa fa-check"></i><b>4.2</b> The Pipeline Operator: <code>%&gt;&gt;%</code></a></li>
<li class="chapter" data-level="4.3" data-path="pipe-nodes-edges-graphs.html"><a href="pipe-nodes-edges-graphs.html"><i class="fa fa-check"></i><b>4.3</b> Nodes, Edges and Graphs</a></li>
<li class="chapter" data-level="4.4" data-path="pipe-modeling.html">
<a href="pipe-modeling.html"><i class="fa fa-check"></i><b>4.4</b> Modeling</a><ul>
<li class="chapter" data-level="4.4.1" data-path="pipe-modeling.html"><a href="pipe-modeling.html#pipe-hyperpars"><i class="fa fa-check"></i><b>4.4.1</b> Setting Hyperparameters</a></li>
<li class="chapter" data-level="4.4.2" data-path="pipe-modeling.html"><a href="pipe-modeling.html#pipe-tuning"><i class="fa fa-check"></i><b>4.4.2</b> Tuning</a></li>
</ul>
</li>
<li class="chapter" data-level="4.5" data-path="pipe-nonlinear.html">
<a href="pipe-nonlinear.html"><i class="fa fa-check"></i><b>4.5</b> Non-Linear Graphs</a><ul>
<li class="chapter" data-level="4.5.1" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles-branching-copying"><i class="fa fa-check"></i><b>4.5.1</b> Branching &amp; Copying</a></li>
<li class="chapter" data-level="4.5.2" data-path="pipe-nonlinear.html">
<a href="pipe-nonlinear.html#pipe-model-ensembles"><i class="fa fa-check"></i><b>4.5.2</b> Model Ensembles</a><ul>
<li class="chapter" data-level="4.5.2.1" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles-bagging"><i class="fa fa-check"></i><b>4.5.2.1</b> Bagging</a></li>
<li class="chapter" data-level="4.5.2.2" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles-stacking"><i class="fa fa-check"></i><b>4.5.2.2</b> Stacking</a></li>
<li class="chapter" data-level="4.5.2.3" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#multilevel-stacking"><i class="fa fa-check"></i><b>4.5.2.3</b> Multilevel Stacking</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="4.6" data-path="pipe-special-ops.html">
<a href="pipe-special-ops.html"><i class="fa fa-check"></i><b>4.6</b> Special Operators</a><ul>
<li class="chapter" data-level="4.6.1" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#imputation-pipeopimpute"><i class="fa fa-check"></i><b>4.6.1</b> Imputation: <code>PipeOpImpute</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#feature-engineering-pipeopmutate"><i class="fa fa-check"></i><b>4.6.2</b> Feature Engineering: <code>PipeOpMutate</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#training-on-data-subsets-pipeopchunk"><i class="fa fa-check"></i><b>4.6.3</b> Training on data subsets: <code>PipeOpChunk</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#feature-selection-pipeopfilter-and-pipeopselect"><i class="fa fa-check"></i><b>4.6.4</b> Feature Selection: <code>PipeOpFilter</code> and <code>PipeOpSelect</code></a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="5" data-path="technical.html">
<a href="technical.html"><i class="fa fa-check"></i><b>5</b> Technical</a><ul>
<li class="chapter" data-level="5.1" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>5.1</b> Parallelization</a></li>
<li class="chapter" data-level="5.2" data-path="error-handling.html">
<a href="error-handling.html"><i class="fa fa-check"></i><b>5.2</b> Error Handling</a><ul>
<li class="chapter" data-level="5.2.1" data-path="error-handling.html"><a href="error-handling.html#encapsulation"><i class="fa fa-check"></i><b>5.2.1</b> Encapsulation</a></li>
<li class="chapter" data-level="5.2.2" data-path="error-handling.html"><a href="error-handling.html#fallback-learners"><i class="fa fa-check"></i><b>5.2.2</b> Fallback learners</a></li>
</ul>
</li>
<li class="chapter" data-level="5.3" data-path="backends.html">
<a href="backends.html"><i class="fa fa-check"></i><b>5.3</b> Database Backends</a><ul>
<li class="chapter" data-level="5.3.1" data-path="backends.html"><a href="backends.html#use-case-nyc-flights"><i class="fa fa-check"></i><b>5.3.1</b> Use Case: NYC Flights</a></li>
<li class="chapter" data-level="5.3.2" data-path="backends.html"><a href="backends.html#preprocessing-with-dplyr"><i class="fa fa-check"></i><b>5.3.2</b> Preprocessing with <code>dplyr</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="backends.html"><a href="backends.html#databackenddplyr"><i class="fa fa-check"></i><b>5.3.3</b> DataBackendDplyr</a></li>
<li class="chapter" data-level="5.3.4" data-path="backends.html"><a href="backends.html#model-fitting"><i class="fa fa-check"></i><b>5.3.4</b> Model fitting</a></li>
<li class="chapter" data-level="5.3.5" data-path="backends.html"><a href="backends.html#cleanup"><i class="fa fa-check"></i><b>5.3.5</b> Cleanup</a></li>
</ul>
</li>
<li class="chapter" data-level="5.4" data-path="paradox.html">
<a href="paradox.html"><i class="fa fa-check"></i><b>5.4</b> Parameters (using <code>paradox</code>)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="paradox.html"><a href="paradox.html#reference-based-objects"><i class="fa fa-check"></i><b>5.4.1</b> Reference Based Objects</a></li>
<li class="chapter" data-level="5.4.2" data-path="paradox.html">
<a href="paradox.html#defining-a-parameter-space"><i class="fa fa-check"></i><b>5.4.2</b> Defining a Parameter Space</a><ul>
<li class="chapter" data-level="5.4.2.1" data-path="paradox.html"><a href="paradox.html#single-parameters"><i class="fa fa-check"></i><b>5.4.2.1</b> Single Parameters</a></li>
<li class="chapter" data-level="5.4.2.2" data-path="paradox.html"><a href="paradox.html#parameter-sets"><i class="fa fa-check"></i><b>5.4.2.2</b> Parameter Sets</a></li>
<li class="chapter" data-level="5.4.2.3" data-path="paradox.html"><a href="paradox.html#vector-parameters"><i class="fa fa-check"></i><b>5.4.2.3</b> Vector Parameters</a></li>
</ul>
</li>
<li class="chapter" data-level="5.4.3" data-path="paradox.html">
<a href="paradox.html#parameter-sampling"><i class="fa fa-check"></i><b>5.4.3</b> Parameter Sampling</a><ul>
<li class="chapter" data-level="5.4.3.1" data-path="paradox.html"><a href="paradox.html#parameter-designs"><i class="fa fa-check"></i><b>5.4.3.1</b> Parameter Designs</a></li>
<li class="chapter" data-level="5.4.3.2" data-path="paradox.html"><a href="paradox.html#grid-design"><i class="fa fa-check"></i><b>5.4.3.2</b> Grid Design</a></li>
<li class="chapter" data-level="5.4.3.3" data-path="paradox.html"><a href="paradox.html#random-sampling"><i class="fa fa-check"></i><b>5.4.3.3</b> Random Sampling</a></li>
<li class="chapter" data-level="5.4.3.4" data-path="paradox.html"><a href="paradox.html#generalized-sampling-the-sampler-class"><i class="fa fa-check"></i><b>5.4.3.4</b> Generalized Sampling: The <code>Sampler</code> Class</a></li>
</ul>
</li>
<li class="chapter" data-level="5.4.4" data-path="paradox.html">
<a href="paradox.html#parameter-transformation"><i class="fa fa-check"></i><b>5.4.4</b> Parameter Transformation</a><ul>
<li class="chapter" data-level="5.4.4.1" data-path="paradox.html"><a href="paradox.html#transformation-between-types"><i class="fa fa-check"></i><b>5.4.4.1</b> Transformation between Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="5.5" data-path="logging.html">
<a href="logging.html"><i class="fa fa-check"></i><b>5.5</b> Logging and Verbosity</a><ul>
<li class="chapter" data-level="5.5.1" data-path="logging.html"><a href="logging.html#available-logging-levels"><i class="fa fa-check"></i><b>5.5.1</b> Available logging levels</a></li>
<li class="chapter" data-level="5.5.2" data-path="logging.html"><a href="logging.html#global-setting"><i class="fa fa-check"></i><b>5.5.2</b> Global Setting</a></li>
<li class="chapter" data-level="5.5.3" data-path="logging.html"><a href="logging.html#changing-mlr3-logging-levels"><i class="fa fa-check"></i><b>5.5.3</b> Changing mlr3 logging levels</a></li>
</ul>
</li>
<li class="chapter" data-level="5.6" data-path="transition.html"><a href="transition.html"><i class="fa fa-check"></i><b>5.6</b> mlr -&gt; mlr3 Transition Guide</a></li>
</ul>
</li>
<li class="chapter" data-level="6" data-path="extending.html">
<a href="extending.html"><i class="fa fa-check"></i><b>6</b> Extending</a><ul>
<li class="chapter" data-level="6.1" data-path="ext-learner.html">
<a href="ext-learner.html"><i class="fa fa-check"></i><b>6.1</b> Extending with Learners</a><ul>
<li class="chapter" data-level="6.1.1" data-path="ext-learner.html"><a href="ext-learner.html#learner-meta-information"><i class="fa fa-check"></i><b>6.1.1</b> Meta-information</a></li>
<li class="chapter" data-level="6.1.2" data-path="ext-learner.html"><a href="ext-learner.html#learner-train"><i class="fa fa-check"></i><b>6.1.2</b> Train function</a></li>
<li class="chapter" data-level="6.1.3" data-path="ext-learner.html"><a href="ext-learner.html#learner-predict"><i class="fa fa-check"></i><b>6.1.3</b> Predict function</a></li>
<li class="chapter" data-level="6.1.4" data-path="ext-learner.html"><a href="ext-learner.html#final-learner"><i class="fa fa-check"></i><b>6.1.4</b> Final learner</a></li>
</ul>
</li>
<li class="chapter" data-level="6.2" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html"><i class="fa fa-check"></i><b>6.2</b> Extending with mlr3pipelines</a><ul>
<li class="chapter" data-level="6.2.1" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html#ext-pipeopcopy"><i class="fa fa-check"></i><b>6.2.1</b> General Case Example: <code>PipeOpCopy</code></a><ul>
<li class="chapter" data-level="6.2.1.1" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#first-steps-inheriting-from-pipeop"><i class="fa fa-check"></i><b>6.2.1.1</b> First Steps: Inheriting from <code>PipeOp</code></a></li>
<li class="chapter" data-level="6.2.1.2" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#channel-definitions"><i class="fa fa-check"></i><b>6.2.1.2</b> Channel Definitions</a></li>
<li class="chapter" data-level="6.2.1.3" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#train-and-predict"><i class="fa fa-check"></i><b>6.2.1.3</b> Train and Predict</a></li>
<li class="chapter" data-level="6.2.1.4" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#putting-it-together"><i class="fa fa-check"></i><b>6.2.1.4</b> Putting it Together</a></li>
</ul>
</li>
<li class="chapter" data-level="6.2.2" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html#ext-pipe-preproc"><i class="fa fa-check"></i><b>6.2.2</b> Special Case: Preprocessing</a><ul>
<li class="chapter" data-level="6.2.2.1" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#example-pipeopdropna"><i class="fa fa-check"></i><b>6.2.2.1</b> Example: <code>PipeOpDropNA</code></a></li>
<li class="chapter" data-level="6.2.2.2" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#example-pipeopscalealways"><i class="fa fa-check"></i><b>6.2.2.2</b> Example: <code>PipeOpScaleAlways</code></a></li>
</ul>
</li>
<li class="chapter" data-level="6.2.3" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html#special-case-preprocessing-with-simple-train"><i class="fa fa-check"></i><b>6.2.3</b> Special Case: Preprocessing with Simple Train</a><ul>
<li class="chapter" data-level="6.2.3.1" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#example-pipeopdropconst"><i class="fa fa-check"></i><b>6.2.3.1</b> Example: <code>PipeOpDropConst</code></a></li>
<li class="chapter" data-level="6.2.3.2" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#example-pipeopscalealwayssimple"><i class="fa fa-check"></i><b>6.2.3.2</b> Example: <code>PipeOpScaleAlwaysSimple</code></a></li>
</ul>
</li>
<li class="chapter" data-level="6.2.4" data-path="extending-mlr3pipelines.html">
<a href="extending-mlr3pipelines.html#ext-pipe-hyperpars"><i class="fa fa-check"></i><b>6.2.4</b> Hyperparameters</a><ul>
<li class="chapter" data-level="6.2.4.1" data-path="extending-mlr3pipelines.html"><a href="extending-mlr3pipelines.html#hyperparameter-example-pipeopscale"><i class="fa fa-check"></i><b>6.2.4.1</b> Hyperparameter Example: <code>PipeOpScale</code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="7" data-path="special-tasks.html">
<a href="special-tasks.html"><i class="fa fa-check"></i><b>7</b> Special Tasks</a><ul>
<li class="chapter" data-level="7.1" data-path="survival.html"><a href="survival.html"><i class="fa fa-check"></i><b>7.1</b> Survival Analysis</a></li>
<li class="chapter" data-level="7.2" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>7.2</b> Spatial Analysis</a></li>
<li class="chapter" data-level="7.3" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i><b>7.3</b> Ordinal Analysis</a></li>
<li class="chapter" data-level="7.4" data-path="functional.html">
<a href="functional.html"><i class="fa fa-check"></i><b>7.4</b> Functional Analysis</a><ul>
<li class="chapter" data-level="7.4.1" data-path="functional.html"><a href="functional.html#how-to-model-functional-data"><i class="fa fa-check"></i><b>7.4.1</b> How to model functional data?</a></li>
</ul>
</li>
<li class="chapter" data-level="7.5" data-path="multilabel.html"><a href="multilabel.html"><i class="fa fa-check"></i><b>7.5</b> Multilabel Classification</a></li>
<li class="chapter" data-level="7.6" data-path="cost-sens.html">
<a href="cost-sens.html"><i class="fa fa-check"></i><b>7.6</b> Cost-Sensitive Classification</a><ul>
<li class="chapter" data-level="7.6.1" data-path="cost-sens.html"><a href="cost-sens.html#a-first-model"><i class="fa fa-check"></i><b>7.6.1</b> A First Model</a></li>
<li class="chapter" data-level="7.6.2" data-path="cost-sens.html"><a href="cost-sens.html#cost-sensitive-measure"><i class="fa fa-check"></i><b>7.6.2</b> Cost-sensitive Measure</a></li>
<li class="chapter" data-level="7.6.3" data-path="cost-sens.html"><a href="cost-sens.html#thresholding"><i class="fa fa-check"></i><b>7.6.3</b> Thresholding</a></li>
<li class="chapter" data-level="7.6.4" data-path="cost-sens.html"><a href="cost-sens.html#threshold-tuning-1"><i class="fa fa-check"></i><b>7.6.4</b> Threshold Tuning</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="8" data-path="interpretation.html">
<a href="interpretation.html"><i class="fa fa-check"></i><b>8</b> Model Interpretation</a><ul>
<li class="chapter" data-level="8.1" data-path="iml.html"><a href="iml.html"><i class="fa fa-check"></i><b>8.1</b> IML</a></li>
<li class="chapter" data-level="8.2" data-path="dalex.html"><a href="dalex.html"><i class="fa fa-check"></i><b>8.2</b> Dalex</a></li>
</ul>
</li>
<li class="chapter" data-level="9" data-path="use-cases.html">
<a href="use-cases.html"><i class="fa fa-check"></i><b>9</b> Use Cases</a><ul>
<li class="chapter" data-level="9.1" data-path="use-case-regr-houses.html">
<a href="use-case-regr-houses.html"><i class="fa fa-check"></i><b>9.1</b> House Price Prediction in King County</a><ul>
<li class="chapter" data-level="9.1.1" data-path="use-case-regr-houses.html">
<a href="use-case-regr-houses.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>9.1.1</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="9.1.1.1" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#distribution-of-the-price"><i class="fa fa-check"></i><b>9.1.1.1</b> Distribution of the price:</a></li>
<li class="chapter" data-level="9.1.1.2" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#association-between-variables"><i class="fa fa-check"></i><b>9.1.1.2</b> Association between variables</a></li>
</ul>
</li>
<li class="chapter" data-level="9.1.2" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#splitting-into-train-and-test-data"><i class="fa fa-check"></i><b>9.1.2</b> Splitting into train and test data</a></li>
<li class="chapter" data-level="9.1.3" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#a-first-model-decision-tree"><i class="fa fa-check"></i><b>9.1.3</b> A first model: Decision Tree</a></li>
<li class="chapter" data-level="9.1.4" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#a-first-baseline-decision-tree"><i class="fa fa-check"></i><b>9.1.4</b> A first baseline: Decision Tree</a></li>
<li class="chapter" data-level="9.1.5" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#many-trees-random-forest"><i class="fa fa-check"></i><b>9.1.5</b> Many Trees: Random Forest</a></li>
<li class="chapter" data-level="9.1.6" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#a-better-baseline-autotuner"><i class="fa fa-check"></i><b>9.1.6</b> A better baseline: <code>AutoTuner</code></a></li>
<li class="chapter" data-level="9.1.7" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#engineering-features-mutating-zip-codes"><i class="fa fa-check"></i><b>9.1.7</b> Engineering Features: Mutating ZIP-Codes</a></li>
<li class="chapter" data-level="9.1.8" data-path="use-case-regr-houses.html"><a href="use-case-regr-houses.html#obtaining-a-sparser-model"><i class="fa fa-check"></i><b>9.1.8</b> Obtaining a sparser model</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="10" data-path="appendix.html">
<a href="appendix.html"><i class="fa fa-check"></i><b>10</b> Appendix</a><ul>
<li class="chapter" data-level="10.1" data-path="list-learners.html"><a href="list-learners.html"><i class="fa fa-check"></i><b>10.1</b> Integrated Learners</a></li>
<li class="chapter" data-level="10.2" data-path="list-measures.html"><a href="list-measures.html"><i class="fa fa-check"></i><b>10.2</b> Integrated Performance Measures</a></li>
<li class="chapter" data-level="10.3" data-path="list-filters.html">
<a href="list-filters.html"><i class="fa fa-check"></i><b>10.3</b> Integrated Filter Methods</a><ul>
<li class="chapter" data-level="10.3.1" data-path="list-filters.html"><a href="list-filters.html#fs-filter-list"><i class="fa fa-check"></i><b>10.3.1</b> Standalone filter methods</a></li>
<li class="chapter" data-level="10.3.2" data-path="list-filters.html"><a href="list-filters.html#fs-filter-embedded-list"><i class="fa fa-check"></i><b>10.3.2</b> Algorithms With Embedded Filter Methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider">
<li><a href="./">Made with <i class="fas fa-heart"></i> for open-source </a></li>

</ul></nav>
</div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">mlr3 manual <img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" width="50"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-"><div id="train-predict" class="section level2">
<h2>
<span class="header-section-number">2.4</span> Train and Predict</h2>
<p>In this section, we explain how <a href="tasks.html#tasks">tasks</a> and <a href="learners.html#learners">learners</a> can be used to train a model and predict to a new dataset.
The concept is demonstrated on a supervised classification using the iris dataset and the <strong>rpart</strong> learner (classification tree).</p>
<p>Training a <a href="learners.html#learners">learner</a> means fitting a model to a given data set.
Subsequently, we want to <a href="train-predict.html#predicting">predict</a> the target value for new observations.
These <a href="train-predict.html#predicting">predictions</a> are compared to the ground truth values to assess the quality of the model.
In sum, the goal of training and predicting is to evaluate the predictive power of different models.</p>
<div id="train-predict-objects" class="section level3">
<h3>
<span class="header-section-number">2.4.1</span> Creating Task and Learner Objects</h3>
<p>The first step is to generate the following <a href="https://mlr3.mlr-org.com">mlr3</a> objects from the <a href="tasks.html#tasks">task dictionary</a> and the <a href="learners.html#learners">learner dictionary</a>, respectively:</p>
<ol style="list-style-type: decimal">
<li>The classification <a href="tasks.html#tasks">task</a>:</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">task =<span class="st"> </span><span class="kw">tsk</span>(<span class="st">"sonar"</span>)</a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>A <a href="learners.html#learners">learner</a> for the classification tree:</li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">learner =<span class="st"> </span><span class="kw">lrn</span>(<span class="st">"classif.rpart"</span>)</a></code></pre></div>
</div>
<div id="split-data" class="section level3">
<h3>
<span class="header-section-number">2.4.2</span> Setting up the train/test splits of the data</h3>
<p>It is common to train on a majority of the data.
Here we use 80% of all available observations and predict on the remaining 20% observations.
For this purpose, we create two index vectors:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">train_set =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(task<span class="op">$</span>nrow, <span class="fl">0.8</span> <span class="op">*</span><span class="st"> </span>task<span class="op">$</span>nrow)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">test_set =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(task<span class="op">$</span>nrow), train_set)</a></code></pre></div>
</div>
<div id="training" class="section level3">
<h3>
<span class="header-section-number">2.4.3</span> Training the learner</h3>
<p>The field <code>model</code> stores the model that is produced in the training step.
Before the <code>train</code> method is called on a learner object, this field is <code>NULL</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">learner<span class="op">$</span>model</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">## NULL</a></code></pre></div>
<p>Next, the classification tree is trained using the train set of the iris task, applying the <code>$train()</code> method of the <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a>:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">learner<span class="op">$</span><span class="kw">train</span>(task, <span class="dt">row_ids =</span> train_set)</a></code></pre></div>
<p>This operation modifies the learner in-place.
We can now access the stored model via the field <code>$model</code>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(learner<span class="op">$</span>model)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">## n= 166 </a>
<a class="sourceLine" id="cb38-3" data-line-number="3">## </a>
<a class="sourceLine" id="cb38-4" data-line-number="4">## node), split, n, loss, yval, (yprob)</a>
<a class="sourceLine" id="cb38-5" data-line-number="5">##       * denotes terminal node</a>
<a class="sourceLine" id="cb38-6" data-line-number="6">## </a>
<a class="sourceLine" id="cb38-7" data-line-number="7">##  1) root 166 80 M (0.51807 0.48193)  </a>
<a class="sourceLine" id="cb38-8" data-line-number="8">##    2) V11&gt;=0.1609 109 33 M (0.69725 0.30275)  </a>
<a class="sourceLine" id="cb38-9" data-line-number="9">##      4) V27&gt;=0.8167 51  4 M (0.92157 0.07843) *</a>
<a class="sourceLine" id="cb38-10" data-line-number="10">##      5) V27&lt; 0.8167 58 29 M (0.50000 0.50000)  </a>
<a class="sourceLine" id="cb38-11" data-line-number="11">##       10) V45&gt;=0.2383 12  0 M (1.00000 0.00000) *</a>
<a class="sourceLine" id="cb38-12" data-line-number="12">##       11) V45&lt; 0.2383 46 17 R (0.36957 0.63043)  </a>
<a class="sourceLine" id="cb38-13" data-line-number="13">##         22) V31&lt; 0.3743 19  6 M (0.68421 0.31579) *</a>
<a class="sourceLine" id="cb38-14" data-line-number="14">##         23) V31&gt;=0.3743 27  4 R (0.14815 0.85185) *</a>
<a class="sourceLine" id="cb38-15" data-line-number="15">##    3) V11&lt; 0.1609 57 10 R (0.17544 0.82456)  </a>
<a class="sourceLine" id="cb38-16" data-line-number="16">##      6) V4&gt;=0.0515 11  4 M (0.63636 0.36364) *</a>
<a class="sourceLine" id="cb38-17" data-line-number="17">##      7) V4&lt; 0.0515 46  3 R (0.06522 0.93478) *</a></code></pre></div>
</div>
<div id="predicting" class="section level3">
<h3>
<span class="header-section-number">2.4.4</span> Predicting</h3>
<p>After the model has been trained, we use the remaining part of the data for prediction.
Remember that we <a href="train-predict.html#split-data">initially split the data</a> in <code>train_set</code> and <code>test_set</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">prediction =<span class="st"> </span>learner<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(task, <span class="dt">row_ids =</span> test_set)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(prediction)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">## &lt;PredictionClassif&gt; for 42 observations:</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">##     row_id truth response</a>
<a class="sourceLine" id="cb39-5" data-line-number="5">##         10     R        R</a>
<a class="sourceLine" id="cb39-6" data-line-number="6">##         12     R        R</a>
<a class="sourceLine" id="cb39-7" data-line-number="7">##         15     R        M</a>
<a class="sourceLine" id="cb39-8" data-line-number="8">## ---                      </a>
<a class="sourceLine" id="cb39-9" data-line-number="9">##        182     M        M</a>
<a class="sourceLine" id="cb39-10" data-line-number="10">##        192     M        M</a>
<a class="sourceLine" id="cb39-11" data-line-number="11">##        208     M        M</a></code></pre></div>
<p>The <code>$predict()</code> method of the <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> returns a <a href="https://mlr3.mlr-org.com/reference/Prediction.html"><code>Prediction</code></a> object.
More precise, as the learner is specialized for classification, a <a href="https://mlr3.mlr-org.com/reference/LearnerClassif.html"><code>LearnerClassif</code></a> returns a <a href="https://mlr3.mlr-org.com/reference/PredictionClassif.html"><code>PredictionClassif</code></a> object.</p>
<p>A prediction objects holds The row ids of the test data, the respective true label of the target column and the respective predictions.
The simplest way to extract this information is by converting to a <code>data.table()</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">as.data.table</span>(prediction))</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">##    row_id truth response</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">## 1:     10     R        R</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">## 2:     12     R        R</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">## 3:     15     R        M</a>
<a class="sourceLine" id="cb40-6" data-line-number="6">## 4:     18     R        M</a>
<a class="sourceLine" id="cb40-7" data-line-number="7">## 5:     19     R        M</a>
<a class="sourceLine" id="cb40-8" data-line-number="8">## 6:     28     R        R</a></code></pre></div>
<p>For classification, you can also extract the confusion matrix:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">prediction<span class="op">$</span>confusion</a>
<a class="sourceLine" id="cb41-2" data-line-number="2">##         truth</a>
<a class="sourceLine" id="cb41-3" data-line-number="3">## response  M  R</a>
<a class="sourceLine" id="cb41-4" data-line-number="4">##        M 19  7</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">##        R  6 10</a></code></pre></div>
</div>
<div id="predict-type" class="section level3">
<h3>
<span class="header-section-number">2.4.5</span> Changing the Predict Type</h3>
<p>Classification learners default to predicting the class label.
However, many classifiers additionally also tell you how sure they are about the predicted label by providing posterior probabilities.
To switch to predicting these probabilities, the <code>predict_type</code> field of a <a href="https://mlr3.mlr-org.com/reference/LearnerClassif.html"><code>LearnerClassif</code></a> must be changed from <code>"response"</code> to <code>"prob"</code>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">learner<span class="op">$</span>predict_type =<span class="st"> "prob"</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="co"># re-fit the model</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4">learner<span class="op">$</span><span class="kw">train</span>(task, <span class="dt">row_ids =</span> train_set)</a>
<a class="sourceLine" id="cb42-5" data-line-number="5"></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="co"># rebuild prediction object</span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7">prediction =<span class="st"> </span>learner<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(task, <span class="dt">row_ids =</span> test_set)</a></code></pre></div>
<p>The prediction object now contains probabilities for all class labels:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co"># data.table conversion</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">as.data.table</span>(prediction))</a>
<a class="sourceLine" id="cb43-3" data-line-number="3">##    row_id truth response  prob.M  prob.R</a>
<a class="sourceLine" id="cb43-4" data-line-number="4">## 1:     10     R        R 0.06522 0.93478</a>
<a class="sourceLine" id="cb43-5" data-line-number="5">## 2:     12     R        R 0.06522 0.93478</a>
<a class="sourceLine" id="cb43-6" data-line-number="6">## 3:     15     R        M 0.92157 0.07843</a>
<a class="sourceLine" id="cb43-7" data-line-number="7">## 4:     18     R        M 0.63636 0.36364</a>
<a class="sourceLine" id="cb43-8" data-line-number="8">## 5:     19     R        M 0.92157 0.07843</a>
<a class="sourceLine" id="cb43-9" data-line-number="9">## 6:     28     R        R 0.14815 0.85185</a>
<a class="sourceLine" id="cb43-10" data-line-number="10"></a>
<a class="sourceLine" id="cb43-11" data-line-number="11"><span class="co"># directly access the predicted labels:</span></a>
<a class="sourceLine" id="cb43-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(prediction<span class="op">$</span>response)</a>
<a class="sourceLine" id="cb43-13" data-line-number="13">## [1] R R M M M R</a>
<a class="sourceLine" id="cb43-14" data-line-number="14">## Levels: M R</a>
<a class="sourceLine" id="cb43-15" data-line-number="15"></a>
<a class="sourceLine" id="cb43-16" data-line-number="16"><span class="co"># directly access the matrix of probabilities:</span></a>
<a class="sourceLine" id="cb43-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(prediction<span class="op">$</span>prob)</a>
<a class="sourceLine" id="cb43-18" data-line-number="18">##            M       R</a>
<a class="sourceLine" id="cb43-19" data-line-number="19">## [1,] 0.06522 0.93478</a>
<a class="sourceLine" id="cb43-20" data-line-number="20">## [2,] 0.06522 0.93478</a>
<a class="sourceLine" id="cb43-21" data-line-number="21">## [3,] 0.92157 0.07843</a>
<a class="sourceLine" id="cb43-22" data-line-number="22">## [4,] 0.63636 0.36364</a>
<a class="sourceLine" id="cb43-23" data-line-number="23">## [5,] 0.92157 0.07843</a>
<a class="sourceLine" id="cb43-24" data-line-number="24">## [6,] 0.14815 0.85185</a></code></pre></div>
<p>Analogously to predicting probabilities, many <a href="https://mlr3.mlr-org.com/reference/LearnerRegr.html"><code>regression learners</code></a> support the extracting of a standard error estimates by setting the predict type to <code>"se"</code>.</p>
</div>
<div id="autoplot-prediction" class="section level3">
<h3>
<span class="header-section-number">2.4.6</span> Plotting Predictions</h3>
<p>Analogously to <a href="tasks.html#autoplot-task">plotting tasks</a>, <a href="https://mlr3viz.mlr-org.com">mlr3viz</a> provides a <a href="https://www.rdocumentation.org/packages/ggplot2/topics/autoplot"><code><a href="https://mlr3viz.mlr-org.com/reference/autoplot.html">autoplot()</a></code></a> method.
All available types are listed on the manual page of <a href="https://mlr3viz.mlr-org.com/reference/autoplot.PredictionClassif.html"><code><a href="https://mlr3viz.mlr-org.com/reference/autoplot.PredictionClassif.html">autoplot.PredictionClassif()</a></code></a> or <a href="https://mlr3viz.mlr-org.com/reference/autoplot.PredictionClassif.html"><code><a href="https://mlr3viz.mlr-org.com/reference/autoplot.PredictionClassif.html">autoplot.PredictionClassif()</a></code></a>, respectively.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mlr3viz)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"></a>
<a class="sourceLine" id="cb44-3" data-line-number="3">task =<span class="st"> </span><span class="kw">tsk</span>(<span class="st">"sonar"</span>)</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">learner =<span class="st"> </span><span class="kw">lrn</span>(<span class="st">"classif.rpart"</span>, <span class="dt">predict_type =</span> <span class="st">"prob"</span>)</a>
<a class="sourceLine" id="cb44-5" data-line-number="5">learner<span class="op">$</span><span class="kw">train</span>(task)</a>
<a class="sourceLine" id="cb44-6" data-line-number="6">prediction =<span class="st"> </span>learner<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(task)</a>
<a class="sourceLine" id="cb44-7" data-line-number="7"><span class="kw"><a href="https://mlr3viz.mlr-org.com/reference/autoplot.html">autoplot</a></span>(prediction)</a></code></pre></div>
<p><img src="mlr3book_files/figure-html/02-basics-040-1.svg" width="672"></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw"><a href="https://mlr3viz.mlr-org.com/reference/autoplot.html">autoplot</a></span>(prediction, <span class="dt">type =</span> <span class="st">"roc"</span>)</a></code></pre></div>
<p><img src="mlr3book_files/figure-html/02-basics-040-2.svg" width="672"></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mlr3viz)</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mlr3learners)</a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/eval.html">local</a></span>({ <span class="co"># we do this locally to not overwrite the objects from previous chunks</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4">    task =<span class="st"> </span><span class="kw">tsk</span>(<span class="st">"mtcars"</span>)</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">    learner =<span class="st"> </span><span class="kw">lrn</span>(<span class="st">"regr.lm"</span>)</a>
<a class="sourceLine" id="cb46-6" data-line-number="6">    learner<span class="op">$</span><span class="kw">train</span>(task)</a>
<a class="sourceLine" id="cb46-7" data-line-number="7">    prediction =<span class="st"> </span>learner<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(task)</a>
<a class="sourceLine" id="cb46-8" data-line-number="8">    <span class="kw"><a href="https://mlr3viz.mlr-org.com/reference/autoplot.html">autoplot</a></span>(prediction)</a>
<a class="sourceLine" id="cb46-9" data-line-number="9">})</a></code></pre></div>
<p><img src="mlr3book_files/figure-html/02-basics-041-1.svg" width="672"></p>
</div>
<div id="measure" class="section level3">
<h3>
<span class="header-section-number">2.4.7</span> Performance assessment</h3>
<p>The last step of an modeling is usually the performance assessment.
The quality of the predictions of a model in <code>mlr3</code> can be assessed with respect to a number of different performance measures.
At the performance assessment we choose a specific performance measure to quantify the predictions.
This is done by comparing the predicted labels with the true labels.
Predefined available measures are stored in <a href="https://mlr3.mlr-org.com/reference/mlr_measures.html"><code>mlr_measures</code></a> (with convenience getter <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>msr()</code></a>):</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">mlr_measures</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">## &lt;DictionaryMeasure&gt; with 51 stored values</a>
<a class="sourceLine" id="cb47-3" data-line-number="3">## Keys: classif.acc, classif.auc, classif.bacc, classif.ce,</a>
<a class="sourceLine" id="cb47-4" data-line-number="4">##   classif.costs, classif.dor, classif.fbeta, classif.fdr, classif.fn,</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">##   classif.fnr, classif.fomr, classif.fp, classif.fpr, classif.logloss,</a>
<a class="sourceLine" id="cb47-6" data-line-number="6">##   classif.mcc, classif.npv, classif.ppv, classif.precision,</a>
<a class="sourceLine" id="cb47-7" data-line-number="7">##   classif.recall, classif.sensitivity, classif.specificity, classif.tn,</a>
<a class="sourceLine" id="cb47-8" data-line-number="8">##   classif.tnr, classif.tp, classif.tpr, debug, oob_error, regr.bias,</a>
<a class="sourceLine" id="cb47-9" data-line-number="9">##   regr.ktau, regr.mae, regr.mape, regr.maxae, regr.medae, regr.medse,</a>
<a class="sourceLine" id="cb47-10" data-line-number="10">##   regr.mse, regr.msle, regr.pbias, regr.rae, regr.rmse, regr.rmsle,</a>
<a class="sourceLine" id="cb47-11" data-line-number="11">##   regr.rrse, regr.rse, regr.rsq, regr.sae, regr.smape, regr.srho,</a>
<a class="sourceLine" id="cb47-12" data-line-number="12">##   regr.sse, selected_features, time_both, time_predict, time_train</a></code></pre></div>
<p>We select the accuracy (<a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.acc.html"><code>classif.acc</code></a>) and call the method <code>$score()</code> of the <a href="https://mlr3.mlr-org.com/reference/Prediction.html"><code>Prediction</code></a> object.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">measure =<span class="st"> </span><span class="kw">msr</span>(<span class="st">"classif.acc"</span>)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">prediction<span class="op">$</span><span class="kw">score</span>(measure)</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">## classif.acc </a>
<a class="sourceLine" id="cb48-4" data-line-number="4">##       0.875</a></code></pre></div>
<p>Note that, if no measure is specified, classification defaults to classification error (<a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.ce.html"><code>classif.ce</code></a>) and regression defaults to the mean squared error (<a href="https://mlr3.mlr-org.com/reference/mlr_measures_regr.mse.html"><code>regr.mse</code></a>).</p>
</div>
</div>
            </section>
</div>
        </div>
      </div>
<a href="learners.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="resampling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script><script src="libs/gitbook-2.6.7/js/lunr.js"></script><script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script><script src="libs/gitbook-2.6.7/js/plugin-search.js"></script><script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script><script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script><script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script><script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script><script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script><script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mlr-org/mlr3book/edit/master/bookdown/02-basics.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/mlr-org/mlr3book/commits/master/02-basics.Rmd",
"text": "Edit history"
},
"view": {
"link": null,
"text": null
},
"download": [["mlr3book.pdf", "PDF"], ["mlr3book-pinp.pdf", "pinp-PDF"]],
"toc": {
"collapse": "section"
}
});
});
</script><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
